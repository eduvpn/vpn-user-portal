<!DOCTYPE html>

<html lang="en">
{% include 'head.twig' %}
<body>
    {% include 'header.twig' %}

    <ul class="mainMenu">
      <li><a href="home">{% trans "Home" %}</a></li>
      <li><a href="new">{% trans "New" %}</a></li>
      <li><a href="configurations">{% trans "Configurations" %}</a></li>
      <li class="active"><a href="account">{% trans "Account" %}</a></li>
      <li><a href="documentation">{% trans "Documentation" %}</a></li>
    </ul>

    <h2>{% trans "Two-factor Authentication" %}</h2>

    <p>
        {% trans "Here you can enroll for two-factor authentication (2FA)." %}
        {% trans 'See the <a href="documentation#2fa">documentation</a> for more information.' %}
    </p>

    {% if not tfa %}
        <p class="warning">
            {% trans "2FA is currently not enabled on the VPN-servers, you can enroll, but it will not (yet) be used!" %}
        </p>
    {% endif %}
        
    <dl>
        <dt>{% trans "Secret" %}</dt>
        <dd><code>{{ secret|e }}</code></dd>
        <dt>QR</dt>
        <dd><img src="otp-qr-code?otp_secret={{ secret|e }}"></dd>
    </dl>

    <p>
        {% trans "Scan the QR code using your 2FA application, or import the secret manually. Confirm the successful configuration by entering a 6 digit OTP generated by the application below." %}
    </p>

    <form method="post" action="otp">
        <label for="otp_key">OTP</label>
        <input type="text" id="otp_key" name="otp_key" maxlength="6" required pattern="[0-9]{6}" autofocus>
        <input type="hidden" name="otp_secret" value="{{ secret|e }}"> 
        <button>{% trans "Validate" %}</button>
    </form>

    {% include 'footer.twig' %}

</body>
</html>
